<
<template>
  <div>
    <yd-card :loading="loading" :title="title" height="400">
      <Chart
        :loading="false"
        :data="data"
        :settings="settings"
        height="350px"
      />
    </yd-card>
  </div>
</template>

<script>
import chartMixins from "@/mixins/chart";
import Chart from "@/components/Chart/Chart";
import { formatData, tooltipAlone } from "@/utils/chart";
export default {
  name: "OnlinToday",
  components:{Chart},
  props: {
    bindParams: Object,
  },
  mixins: [chartMixins],
  data() {
    return {
      API_URI: "POST /statistic/app/global/getallactiveofday",
      settings: {
        type: "line",
      },
      title: "实时在线(个)",
    };
  },
  mounted() {
    this.$nextTick(() => {
      this.init();
    });
  },
  methods: {
    async init(params = {}) {
      params = {
        ...params,
        ...this.bindParams,
      };
      console.log(1);
      try {
        const data = await this.fetchData(params);
    //     const data = {
    //     "trend": {
    //         "x_data": [
    //             "2022-12-17 00:00:00",
    //             "2022-12-17 00:10:00",
    //             "2022-12-17 00:20:00",
    //             "2022-12-17 00:30:00",
    //             "2022-12-17 00:40:00",
    //             "2022-12-17 00:50:00",
    //             "2022-12-17 01:00:00",
    //             "2022-12-17 01:10:00",
    //             "2022-12-17 01:20:00",
    //             "2022-12-17 01:30:00",
    //             "2022-12-17 01:40:00",
    //             "2022-12-17 01:50:00",
    //             "2022-12-17 02:00:00",
    //             "2022-12-17 02:10:00",
    //             "2022-12-17 02:20:00",
    //             "2022-12-17 02:30:00",
    //             "2022-12-17 02:40:00",
    //             "2022-12-17 02:50:00",
    //             "2022-12-17 03:00:00",
    //             "2022-12-17 03:10:00",
    //             "2022-12-17 03:20:00",
    //             "2022-12-17 03:30:00",
    //             "2022-12-17 03:40:00",
    //             "2022-12-17 03:50:00",
    //             "2022-12-17 04:00:00",
    //             "2022-12-17 04:10:00",
    //             "2022-12-17 04:20:00",
    //             "2022-12-17 04:30:00",
    //             "2022-12-17 04:40:00",
    //             "2022-12-17 04:50:00",
    //             "2022-12-17 05:00:00",
    //             "2022-12-17 05:10:00",
    //             "2022-12-17 05:20:00",
    //             "2022-12-17 05:30:00",
    //             "2022-12-17 05:40:00",
    //             "2022-12-17 05:50:00",
    //             "2022-12-17 06:00:00",
    //             "2022-12-17 06:10:00",
    //             "2022-12-17 06:20:00",
    //             "2022-12-17 06:30:00",
    //             "2022-12-17 06:40:00",
    //             "2022-12-17 06:50:00",
    //             "2022-12-17 07:00:00",
    //             "2022-12-17 07:10:00",
    //             "2022-12-17 07:20:00",
    //             "2022-12-17 07:30:00",
    //             "2022-12-17 07:40:00",
    //             "2022-12-17 07:50:00",
    //             "2022-12-17 08:00:00",
    //             "2022-12-17 08:10:00",
    //             "2022-12-17 08:20:00",
    //             "2022-12-17 08:30:00",
    //             "2022-12-17 08:40:00",
    //             "2022-12-17 08:50:00",
    //             "2022-12-17 09:00:00",
    //             "2022-12-17 09:10:00",
    //             "2022-12-17 09:20:00",
    //             "2022-12-17 09:30:00",
    //             "2022-12-17 09:40:00",
    //             "2022-12-17 09:50:00",
    //             "2022-12-17 10:00:00",
    //             "2022-12-17 10:10:00",
    //             "2022-12-17 10:20:00",
    //             "2022-12-17 10:30:00",
    //             "2022-12-17 10:40:00",
    //             "2022-12-17 10:50:00",
    //             "2022-12-17 11:00:00",
    //             "2022-12-17 11:10:00",
    //             "2022-12-17 11:20:00",
    //             "2022-12-17 11:30:00",
    //             "2022-12-17 11:40:00",
    //             "2022-12-17 11:50:00",
    //             "2022-12-17 12:00:00",
    //             "2022-12-17 12:10:00",
    //             "2022-12-17 12:20:00",
    //             "2022-12-17 12:30:00",
    //             "2022-12-17 12:40:00",
    //             "2022-12-17 12:50:00",
    //             "2022-12-17 13:00:00",
    //             "2022-12-17 13:10:00",
    //             "2022-12-17 13:20:00",
    //             "2022-12-17 13:30:00",
    //             "2022-12-17 13:40:00",
    //             "2022-12-17 13:50:00",
    //             "2022-12-17 14:00:00",
    //             "2022-12-17 14:10:00",
    //             "2022-12-17 14:20:00",
    //             "2022-12-17 14:30:00",
    //             "2022-12-17 14:40:00",
    //             "2022-12-17 14:50:00",
    //             "2022-12-17 15:00:00",
    //             "2022-12-17 15:10:00",
    //             "2022-12-17 15:20:00",
    //             "2022-12-17 15:30:00",
    //             "2022-12-17 15:40:00",
    //             "2022-12-17 15:50:00",
    //             "2022-12-17 16:00:00",
    //             "2022-12-17 16:10:00",
    //             "2022-12-17 16:20:00",
    //             "2022-12-17 16:30:00",
    //             "2022-12-17 16:40:00",
    //             "2022-12-17 16:50:00",
    //             "2022-12-17 17:00:00",
    //             "2022-12-17 17:10:00",
    //             "2022-12-17 17:20:00",
    //             "2022-12-17 17:30:00",
    //             "2022-12-17 17:40:00",
    //             "2022-12-17 17:50:00",
    //             "2022-12-17 18:00:00",
    //             "2022-12-17 18:10:00",
    //             "2022-12-17 18:20:00",
    //             "2022-12-17 18:30:00",
    //             "2022-12-17 18:40:00",
    //             "2022-12-17 18:50:00",
    //             "2022-12-17 19:00:00",
    //             "2022-12-17 19:10:00",
    //             "2022-12-17 19:20:00",
    //             "2022-12-17 19:30:00",
    //             "2022-12-17 19:40:00",
    //             "2022-12-17 19:50:00",
    //             "2022-12-17 20:00:00",
    //             "2022-12-17 20:10:00",
    //             "2022-12-17 20:20:00"
    //         ],
    //         "y_data": {
    //             "unit": "个",
    //             "data": [
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 1,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0,
    //                 0
    //             ]
    //         }
    //     }
    // }

        const unit =
          data.trend && data.trend.y_data ? data.trend.y_data.unit : "";
        this.settings.yAxisName = [`单位（${unit}）`];
        this.data = formatData(data.trend, ["时间", "实时在线"]);
        this.data.tooltip = tooltipAlone(unit);
      } catch (error) {
        const unit = "QPS";
        this.settings.yAxisName = [`单位（${unit}）`];
        this.data = formatData(
          {
            x_data: [0],
            y_data: {
              data: [0],
              unit: "个",
            },
          },
          ["时间", "实时在线"]
        );
        this.data.tooltip = tooltipAlone(unit);
      } finally {
        this.loading = false;
      }
    }
  },
};
</script>

<style lang="scss" scoped></style>
